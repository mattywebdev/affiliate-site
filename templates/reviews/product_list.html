{% extends "base.html" %}
{% block content %}

<h1>Product List</h1>

<form method="get" style="display:flex; gap:12px; align-items:center; margin:12px 0;">
  <input type="text" name="q" placeholder="Search..." value="{{ q }}">
  <select name="sort">
    <option value="name" {% if sort == "name" %}selected{% endif %}>Name (A–Z)</option>
    <option value="-name" {% if sort == "-name" %}selected{% endif %}>Name (Z–A)</option>
    <option value="price" {% if sort == "price" %}selected{% endif %}>Price (low → high)</option>
    <option value="-price" {% if sort == "-price" %}selected{% endif %}>Price (high → low)</option>
  </select>
  <button type="submit">Apply</button>
</form>

<div style="display:grid; grid-template-columns: repeat(2, 1fr); gap:16px;">
  {% for product in products %}
    <div style="border:1px solid #ddd; padding:12px; border-radius:10px;">
      {% if product.image %}
        <img src="{{ product.image.url }}" alt="{{ product.name }}" style="width:100%; height:180px; object-fit:cover; border-radius:10px;">
      {% endif %}

      <h2 style="margin:10px 0 6px;">
        <a href="{% url 'reviews:product_detail' product.slug %}">{{ product.name }}</a>
      </h2>

      {% if product.category %}
        <p style="margin:0 0 8px;">
          Category:
          <a href="{% url 'reviews:category_detail' product.category.slug %}">{{ product.category.name }}</a>
        </p>
      {% endif %}

      <p style="margin:0 0 8px;">£{{ product.price }}</p>
      <p style="margin:0;">{{ product.description|truncatechars:90 }}</p>
    </div>
  {% empty %}
    <p>No products found.</p>
  {% endfor %}
</div>

<div style="margin-top:16px; display:flex; gap:12px; align-items:center;">
  {% if page_obj.has_previous %}
    <a href="?q={{ q }}&sort={{ sort }}&page={{ page_obj.previous_page_number }}">Prev</a>
  {% endif %}

  <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

  {% if page_obj.has_next %}
    <a href="?q={{ q }}&sort={{ sort }}&page={{ page_obj.next_page_number }}">Next</a>
  {% endif %}
</div>

{% endblock %}